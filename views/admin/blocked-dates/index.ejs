<div class="admin-toolbar" style="display: flex; justify-content: space-between; align-items: flex-start; gap: 1.5rem; flex-wrap: wrap;">
    <div class="form-card" style="flex: 1; min-width: 300px;">
        <h3>Ajouter une date bloquée</h3>
        <form method="POST" action="/admin/blocked-dates">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <div class="form-group-admin">
                <label for="blockedDate">Date</label>
                <input type="date" id="blockedDate" name="blockedDate" required>
            </div>
            <div class="form-group-admin">
                <label for="reason">Motif (optionnel)</label>
                <input type="text" id="reason" name="reason" placeholder="Ex: Vacances, Jour férié...">
            </div>
            <div class="form-group-admin">
                <label>Type de blocage</label>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <label style="display: flex; align-items: center; gap: 0.3rem; margin: 0; font-weight: normal; cursor: pointer;">
                        <input type="radio" name="blockType" value="full" checked> Journée entière
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.3rem; margin: 0; font-weight: normal; cursor: pointer;">
                        <input type="radio" name="blockType" value="morning"> Matin (Plage 1)
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.3rem; margin: 0; font-weight: normal; cursor: pointer;">
                        <input type="radio" name="blockType" value="afternoon"> Après-midi (Plage 2)
                    </label>
                </div>
            </div>
            <div class="form-group-admin" style="display: flex; align-items: center; gap: 0.5rem;">
                <input type="checkbox" id="isRecurring" name="isRecurring" value="true">
                <label for="isRecurring" style="margin: 0;">Récurrent chaque année</label>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary-admin">Bloquer cette date</button>
            </div>
        </form>
    </div>
</div>

<div style="margin-top: 1.5rem;">
    <% if (blockedDates.length === 0) { %>
    <div class="empty-state">Aucune date bloquée pour le moment.</div>
    <% } else { %>
    <div class="table-responsive">
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Motif</th>
                    <th>Type</th>
                    <th>Récurrent</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% blockedDates.forEach(bd => { %>
                <tr>
                    <td><strong><%= formatDate(bd.blocked_date) %></strong></td>
                    <td><%= bd.reason || '—' %></td>
                    <td>
                        <% if (bd.block_type === 'morning') { %>
                        <span class="badge" style="background: #f59e0b; color: #fff;">Matin</span>
                        <% } else if (bd.block_type === 'afternoon') { %>
                        <span class="badge" style="background: #3b82f6; color: #fff;">Après-midi</span>
                        <% } else { %>
                        <span class="badge badge-gray">Journée</span>
                        <% } %>
                    </td>
                    <td>
                        <% if (bd.is_recurring) { %>
                        <span class="badge badge-gold">Chaque année</span>
                        <% } else { %>
                        <span class="badge badge-gray">Ponctuel</span>
                        <% } %>
                    </td>
                    <td>
                        <form method="POST" action="/admin/blocked-dates/<%= bd.id %>?_method=DELETE" style="display:inline;">
                            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                            <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Débloquer cette date ?')">
                                Supprimer
                            </button>
                        </form>
                    </td>
                </tr>
                <% }) %>
            </tbody>
        </table>
    </div>
    <% } %>
</div>
